import { classToPlain } from 'class-transformer';
import { ɵBaseFilterableQuery } from './base-filterable-query';
import { ɵQueryOperationType } from './query-operation-type';
import { ɵAggregationEvalType } from '../enums';
import { ɵAggregationFunctionColumn, ɵAggregationSubQueryColumn, ɵArithmeticQueryColumn, ɵDatePartFunctionColumn, ɵEntityQueryColumn, ɵLengthFunctionColumn, ɵMacrosFunctionColumn, ɵParameterQueryColumn, ɵWindowFunctionColumn } from '../columns';
import { ɵItemNotFoundException, ɵValidationUtilities } from '../../../exceptions';
import { ɵAggregationFunctionExpression, ɵColumnExpression } from '../expressions';
/**
 * @public
 */
export class ɵEntitySchemaQuery extends ɵBaseFilterableQuery {
    constructor(rootSchemaName) {
        super(ɵQueryOperationType.Select, rootSchemaName);
        this._columns = new Map();
        this.isDistinct = false;
        /**
         * Number of rows to select.
         */
        this.rowCount = -1;
        /**
         * Rows count to skip.
         */
        this.rowsOffset = -1;
        this.useLocalization = true;
        this.useRecordDeactivation = false;
        this._getIsPageable = () => this.rowCount > 0 && this.rowsOffset > -1;
    }
    _internalAddColumn(key, column) {
        if (!this._columns.has(key)) {
            this._columns.set(key, column);
        }
    }
    // endregion
    // region Methods: Public
    /**
     * Returns column instance by column alias.
     * @param columnAlias Column alias.
     * @returns [BaseQueryColumn] Column instance.
     */
    getColumn(columnAlias) {
        if (!this._columns.has(columnAlias)) {
            throw new ɵItemNotFoundException(columnAlias);
        }
        return this.findColumn(columnAlias);
    }
    /**
     * Returns column instance by column alias if not found returns null.
     */
    findColumn(columnAlias) {
        return this._columns.get(columnAlias);
    }
    /**
     * @inheritDoc
     */
    getMetadata() {
        return {
            ...super.getMetadata(),
            columns: {
                items: classToPlain(this._columns, { exposeUnsetFields: false, excludePrefixes: ['_'] }),
            },
            allColumns: false,
            isDistinct: this.isDistinct,
            ignoreDisplayValues: false,
            rowCount: this.rowCount,
            rowsOffset: this.rowsOffset,
            isPageable: this._getIsPageable(),
            conditionalValues: this.conditionalValues ? this.conditionalValues : null,
            isHierarchical: false,
            hierarchicalMaxDepth: 0,
            hierarchicalColumnName: null,
            hierarchicalColumnValue: null,
            useLocalization: this.useLocalization,
            useRecordDeactivation: this.useRecordDeactivation,
        };
    }
    /**
     * Add column.
     * @param column Column path.
     * @param columnAlias Column alias.
     * @returns [BaseQueryColumn] Column instance.
     */
    addColumn(column, columnAlias) {
        this._internalAddColumn(columnAlias, column);
        return column;
    }
    /**
     * Add column by column path.
     * @param columnPath Column path.
     * @param columnAlias Column alias.
     * @returns [EntityQueryColumn] Column instance.
     */
    addSchemaColumn(columnPath, columnAlias) {
        ɵValidationUtilities.checkArgumentEmpty('columnPath', columnPath);
        const column = new ɵEntityQueryColumn(columnPath);
        this._internalAddColumn(columnAlias || columnPath, column);
        return column;
    }
    /**
     * Add aggregation sub query column.
     * @param columnPath Column path.
     * @param aggregationType Aggregation type.
     * @param subFilters Sub query filters.
     * @param columnAlias Column alias.
     * @returns [AggregationSubQueryColumn] Column instance.
     */
    addAggregationSubQueryColumn(columnPath, aggregationType, aggregationConfig, columnAlias) {
        const column = new ɵAggregationSubQueryColumn(columnPath, aggregationType, aggregationConfig.filter, aggregationConfig.sortByDirection, aggregationConfig.sortByColumn);
        this._internalAddColumn(columnAlias || columnPath, column);
        return column;
    }
    /**
     * Add parameter column.
     * @param value Parameter value.
     * @param dataValueType Parameter data value type.
     * @param columnAlias Column alias.
     * @returns [ParameterQueryColumn] Column instance.
     */
    addParameterColumn(value, dataValueType, columnAlias) {
        const column = new ɵParameterQueryColumn(value, dataValueType);
        this._internalAddColumn(columnAlias, column);
        return column;
    }
    /**
     * Add arithmetic column.
     * @param arithmeticOperation Arithmetic operation.
     * @param leftArithmeticOperand Left arithmetic operand expression.
     * @param rightArithmeticOperand Right arithmetic operand expression.
     * @param columnAlias Column alias.
     * @returns [ArithmeticQueryColumn] Column instance.
     */
    addArithmeticColumn(arithmeticOperation, leftArithmeticOperand, rightArithmeticOperand, columnAlias) {
        const column = new ɵArithmeticQueryColumn(arithmeticOperation, leftArithmeticOperand, rightArithmeticOperand);
        this._internalAddColumn(columnAlias, column);
        return column;
    }
    /**
     * Add macros function column.
     * @param queryMacrosType Macros type.
     * @param columnAlias Column alias.
     * @returns [MacrosFunctionColumn] Column instance.
     */
    addMacrosFunctionColumn(queryMacrosType, columnAlias) {
        const column = new ɵMacrosFunctionColumn(queryMacrosType);
        this._internalAddColumn(columnAlias, column);
        return column;
    }
    /**
     * Add date part function column.
     * @param columnPath Column path.
     * @param datePartType Date part type.
     * @param columnAlias Column alias.
     * @returns [DatePartFunctionColumn] Column instance.
     */
    addDatePartFunctionColumn(columnPath, datePartType, columnAlias) {
        const functionArgument = new ɵColumnExpression({ columnPath });
        const column = new ɵDatePartFunctionColumn(datePartType, functionArgument);
        this._internalAddColumn(columnAlias, column);
        return column;
    }
    /**
     * Add aggregation function column.
     * @param columnPath Column path.
     * @param aggregationType Aggregation type.
     * @param columnAlias Column alias.
     * @param aggregationEvalType Aggregation eval type.
     * @returns [AggregationFunctionColumn] Column instance.
     */
    addAggregationFunctionColumn(columnPath, aggregationType, columnAlias, aggregationEvalType = ɵAggregationEvalType.None) {
        const functionArgument = new ɵColumnExpression({ columnPath });
        const column = new ɵAggregationFunctionColumn(aggregationType, aggregationEvalType, functionArgument);
        this._internalAddColumn(columnAlias, column);
        return column;
    }
    /**
     * Add length function column.
     * @param columnPath Column path.
     * @param columnAlias Column alias.
     * @returns [LengthFunctionColumn] Column instance.
     */
    addLengthFunctionColumn(columnPath, columnAlias) {
        const functionArgument = new ɵColumnExpression({ columnPath });
        const column = new ɵLengthFunctionColumn(functionArgument);
        this._internalAddColumn(columnAlias, column);
        return column;
    }
    /**
     * Add window function column.
     * @param columnPath Column path.
     * @param aggregationType Aggregation type.
     * @param columnAlias Column alias.
     * @param aggregationEvalType Aggregation eval type.
     * @returns [WindowFunctionColumn] Column instance.
     */
    addWindowFunctionColumn(columnPath, aggregationType, columnAlias, aggregationEvalType = ɵAggregationEvalType.None) {
        const functionArgument = new ɵAggregationFunctionExpression({
            aggregationType,
            aggregationEvalType,
            functionArgument: new ɵColumnExpression({ columnPath }),
        });
        const column = new ɵWindowFunctionColumn(functionArgument);
        this._internalAddColumn(columnAlias, column);
        return column;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW50aXR5LXNjaGVtYS1xdWVyeS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL2xpYnMvZGV2a2l0L2Jhc2Uvc3JjL2xpYi9wdWJsaWMvZXNxL2RhdGEtbW9kZWwvcXVlcmllcy9lbnRpdHktc2NoZW1hLXF1ZXJ5LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBQyxZQUFZLEVBQUMsTUFBTSxtQkFBbUIsQ0FBQztBQUUvQyxPQUFPLEVBQUMsb0JBQW9CLEVBQUMsTUFBTSx5QkFBeUIsQ0FBQztBQUM3RCxPQUFPLEVBQUMsbUJBQW1CLEVBQUMsTUFBTSx3QkFBd0IsQ0FBQztBQUMzRCxPQUFPLEVBQUMsb0JBQW9CLEVBQXlFLE1BQU0sVUFBVSxDQUFDO0FBRXRILE9BQU8sRUFDTiwwQkFBMEIsRUFDMUIsMEJBQTBCLEVBQzFCLHNCQUFzQixFQUNKLHVCQUF1QixFQUN6QyxrQkFBa0IsRUFBRSxxQkFBcUIsRUFBRSxxQkFBcUIsRUFDaEUscUJBQXFCLEVBQUUscUJBQXFCLEVBQzVDLE1BQU0sWUFBWSxDQUFDO0FBQ3BCLE9BQU8sRUFBQyxzQkFBc0IsRUFBRSxvQkFBb0IsRUFBQyxNQUFNLHFCQUFxQixDQUFDO0FBR2pGLE9BQU8sRUFBQyw4QkFBOEIsRUFBbUIsaUJBQWlCLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQVdsRzs7R0FFRztBQUNILE1BQU0sT0FBTyxrQkFBbUIsU0FBUSxvQkFBb0I7SUF3QjNELFlBQVksY0FBc0I7UUFDakMsS0FBSyxDQUFDLG1CQUFtQixDQUFDLE1BQU0sRUFBRSxjQUFjLENBQUMsQ0FBQztRQXhCM0MsYUFBUSxHQUFHLElBQUksR0FBRyxFQUE0QixDQUFDO1FBRWhELGVBQVUsR0FBRyxLQUFLLENBQUM7UUFFMUI7O1dBRUc7UUFDSSxhQUFRLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFFckI7O1dBRUc7UUFDSSxlQUFVLEdBQUcsQ0FBQyxDQUFD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QWU7WUFDZixtQkFBbUI7WUFDbkIsZ0JBQWdCLEVBQUUsSUFBSSxpQkFBaUIsQ0FBQyxFQUFDLFVBQVUsRUFBQyxDQUFDO1NBQ3JELENBQUMsQ0FBQztRQUNILE1BQU0sTUFBTSxHQUFHLElBQUkscUJBQXFCLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztRQUMzRCxJQUFJLENBQUMsa0JBQWtCLENBQUMsV0FBVyxFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBQzdDLE9BQU8sTUFBTSxDQUFDO0lBQ2YsQ0FBQztDQUNEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtjbGFzc1RvUGxhaW59IGZyb20gJ2NsYXNzLXRyYW5zZm9ybWVyJztcblxuaW1wb3J0IHvJtUJhc2VGaWx0ZXJhYmxlUXVlcnl9IGZyb20gJy4vYmFzZS1maWx0ZXJhYmxlLXF1ZXJ5JztcbmltcG9ydCB7ybVRdWVyeU9wZXJhdGlvblR5cGV9IGZyb20gJy4vcXVlcnktb3BlcmF0aW9uLXR5cGUnO1xuaW1wb3J0IHvJtUFnZ3JlZ2F0aW9uRXZhbFR5cGUsIMm1QXJpdGhtZXRpY09wZXJhdGlvbiwgybVEYXRlUGFydFR5cGUsIMm1RXhwcmVzc2lvblR5cGUsIMm1UXVlcnlNYWNyb3NUeXBlfSBmcm9tICcuLi9lbnVtcyc7XG5pbXBvcnQge8m1QWdncmVnYXRpb25UeXBlLCDJtURhdGFWYWx1ZVR5cGV9IGZyb20gJy4uLy4uLy4uL2VudW1zJztcbmltcG9ydCB7XG5cdMm1QWdncmVnYXRpb25GdW5jdGlvbkNvbHVtbixcblx0ybVBZ2dyZWdhdGlvblN1YlF1ZXJ5Q29sdW1uLFxuXHTJtUFyaXRobWV0aWNRdWVyeUNvbHVtbixcblx0ybVCYXNlUXVlcnlDb2x1bW4sIMm1RGF0ZVBhcnRGdW5jdGlvbkNvbHVtbixcblx0ybVFbnRpdHlRdWVyeUNvbHVtbiwgybVMZW5ndGhGdW5jdGlvbkNvbHVtbiwgybVNYWNyb3NGdW5jdGlvbkNvbHVtbixcblx0ybVQYXJhbWV0ZXJRdWVyeUNvbHVtbiwgybVXaW5kb3dGdW5jdGlvbkNvbHVtblxufSBmcm9tICcuLi9jb2x1bW5zJztcbmltcG9ydCB7ybVJdGVtTm90Rm91bmRFeGNlcHRpb24sIMm1VmFsaWRhdGlvblV0aWxpdGllc30gZnJvbSAnLi4vLi4vLi4vZXhjZXB0aW9ucyc7XG5pbXBvcnQge8m1RGF0YVNvdXJjZUFnZ3JlZ2F0aW9uQ29uZmlnLCDJtURhdGFTb3VyY2VJbnN0YW5jZUNvbmZpZ30gZnJvbSAnLi4vLi4vLi4vc2VydmljZXMnO1xuaW1wb3J0IHvJtUVudGl0eUNvbHVtblZhbHVlfSBmcm9tICcuLi8uLi8uLi90eXBlcyc7XG5pbXBvcnQge8m1QWdncmVnYXRpb25GdW5jdGlvbkV4cHJlc3Npb24sIMm1QmFzZUV4cHJlc3Npb24sIMm1Q29sdW1uRXhwcmVzc2lvbn0gZnJvbSAnLi4vZXhwcmVzc2lvbnMnO1xuXG5cbmV4cG9ydCBpbnRlcmZhY2UgybVDb25kaXRpb25hbFZhbHVlSXRlbSB7XG5cdGV4cHJlc3Npb25UeXBlOiDJtUV4cHJlc3Npb25UeXBlO1xuXHRwYXJhbWV0ZXI6IHtcblx0XHRkYXRhVmFsdWVUeXBlOiDJtURhdGFWYWx1ZVR5cGU7XG5cdFx0dmFsdWU6IHN0cmluZztcblx0fTtcbn1cblxuLyoqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBjbGFzcyDJtUVudGl0eVNjaGVtYVF1ZXJ5IGV4dGVuZHMgybVCYXNlRmlsdGVyYWJsZVF1ZXJ5IHtcblx0cHJpdmF0ZSBfY29sdW1ucyA9IG5ldyBNYXA8c3RyaW5nLCDJtUJhc2VRdWVyeUNvbHVtbj4oKTtcblxuXHRwdWJsaWMgaXNEaXN0aW5jdCA9IGZhbHNlO1xuXG5cdC8qKlxuXHQgKiBOdW1iZXIgb2Ygcm93cyB0byBzZWxlY3QuXG5cdCAqL1xuXHRwdWJsaWMgcm93Q291bnQgPSAtMTtcblxuXHQvKipcblx0ICogUm93cyBjb3VudCB0byBza2lwLlxuXHQgKi9cblx0cHVibGljIHJvd3NPZmZzZXQgPSAtMTtcblxuXHQvKipcblx0ICogUXVlcnkgY29uZGl0aW9uYWwgdmFsdWVzXG5cdCAqL1xuXHRwdWJsaWMgY29uZGl0aW9uYWxWYWx1ZXM/OiBudWxsIHwgeyBpdGVtczogdW5rbm93biB9O1xuXG5cdHB1YmxpYyB1c2VMb2NhbGl6YXRpb24gPSB0cnVlO1xuXG5cdHB1YmxpYyB1c2VSZWNvcmREZWFjdGl2YXRpb24gPSBmYWxzZTtcblxuXHRjb25zdHJ1Y3Rvcihyb290U2NoZW1hTmFtZTogc3RyaW5nKSB7XG5cdFx0c3VwZXIoybVRdWVyeU9wZXJhdGlvblR5cGUuU2VsZWN0LCByb290U2NoZW1hTmFtZSk7XG5cdH1cblxuXHRwcml2YXRlIF9pbnRlcm5hbEFkZENvbHVtbihrZXk6IHN0cmluZywgY29sdW1uOiDJtUJhc2VRdWVyeUNvbHVtbik6IHZvaWQge1xuXHRcdGlmICghdGhpcy5fY29sdW1ucy5oYXMoa2V5KSkge1xuXHRcdFx0dGhpcy5fY29sdW1ucy5zZXQoa2V5LCBjb2x1bW4pO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgX2dldElzUGFnZWFibGUgPSAoKTogYm9vbGVhbiA9PiB0aGlzLnJvd0NvdW50ID4gMCAmJiB0aGlzLnJvd3NPZmZzZXQgPiAtMTtcblxuXHQvLyBlbmRyZWdpb25cblxuXHQvLyByZWdpb24gTWV0aG9kczogUHVibGljXG5cblx0LyoqXG5cdCAqIFJldHVybnMgY29sdW1uIGluc3RhbmNlIGJ5IGNvbHVtbiBhbGlhcy5cblx0ICogQHBhcmFtIGNvbHVtbkFsaWFzIENvbHVtbiBhbGlhcy5cblx0ICogQHJldHVybnMgW0Jhc2VRdWVyeUNvbHVtbl0gQ29sdW1uIGluc3RhbmNlLlxuXHQgKi9cblx0cHVibGljIGdldENvbHVtbihjb2x1bW5BbGlhczogc3RyaW5nKTogybVCYXNlUXVlcnlDb2x1bW4ge1xuXHRcdGlmICghdGhpcy5fY29sdW1ucy5oYXMoY29sdW1uQWxpYXMpKSB7XG5cdFx0XHR0aHJvdyBuZXcgybVJdGVtTm90Rm91bmRFeGNlcHRpb24oY29sdW1uQWxpYXMpO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5maW5kQ29sdW1uKGNvbHVtbkFsaWFzKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZXR1cm5zIGNvbHVtbiBpbnN0YW5jZSBieSBjb2x1bW4gYWxpYXMgaWYgbm90IGZvdW5kIHJldHVybnMgbnVsbC5cblx0ICovXG5cdHB1YmxpYyBmaW5kQ29sdW1uKGNvbHVtbkFsaWFzOiBzdHJpbmcpOiDJtUJhc2VRdWVyeUNvbHVtbiB7XG5cdFx0cmV0dXJuIHRoaXMuX2NvbHVtbnMuZ2V0KGNvbHVtbkFsaWFzKSBhcyDJtUJhc2VRdWVyeUNvbHVtbjtcblx0fVxuXG5cdC8qKlxuXHQgKiBAaW5oZXJpdERvY1xuXHQgKi9cblx0cHVibGljIGdldE1ldGFkYXRhKCk6IFJlY29yZDxzdHJpbmcsIHVua25vd24+IHtcblx0XHRyZXR1cm4ge1xuXHRcdFx0Li4uc3VwZXIuZ2V0TWV0YWRhdGEoKSxcblx0XHRcdGNvbHVtbnM6IHtcblx0XHRcdFx0aXRlbXM6IGNsYXNzVG9QbGFpbih0aGlzLl9jb2x1bW5zLCB7ZXhwb3NlVW5zZXRGaWVsZHM6IGZhbHNlLCBleGNsdWRlUHJlZml4ZXM6IFsnXyddfSksXG5cdFx0XHR9LFxuXHRcdFx0YWxsQ29sdW1uczogZmFsc2UsXG5cdFx0XHRpc0Rpc3RpbmN0OiB0aGlzLmlzRGlzdGluY3QsXG5cdFx0XHRpZ25vcmVEaXNwbGF5VmFsdWVzOiBmYWxzZSxcblx0XHRcdHJvd0NvdW50OiB0aGlzLnJvd0NvdW50LFxuXHRcdFx0cm93c09mZnNldDogdGhpcy5yb3dzT2Zmc2V0LFxuXHRcdFx0aXNQYWdlYWJsZTogdGhpcy5fZ2V0SXNQYWdlYWJsZSgpLFxuXHRcdFx0Y29uZGl0aW9uYWxWYWx1ZXM6IHRoaXMuY29uZGl0aW9uYWxWYWx1ZXMgPyB0aGlzLmNvbmRpdGlvbmFsVmFsdWVzIDogbnVsbCxcblx0XHRcdGlzSGllcmFyY2hpY2FsOiBmYWxzZSxcblx0XHRcdGhpZXJhcmNoaWNhbE1heERlcHRoOiAwLFxuXHRcdFx0aGllcmFyY2hpY2FsQ29sdW1uTmFtZTogbnVsbCxcblx0XHRcdGhpZXJhcmNoaWNhbENvbHVtblZhbHVlOiBudWxsLFxuXHRcdFx0dXNlTG9jYWxpemF0aW9uOiB0aGlzLnVzZUxvY2FsaXphdGlvbixcblx0XHRcdHVzZVJlY29yZERlYWN0aXZhdGlvbjogdGhpcy51c2VSZWNvcmREZWFjdGl2YXRpb24sXG5cdFx0fTtcblx0fVxuXG5cdC8qKlxuXHQgKiBBZGQgY29sdW1uLlxuXHQgKiBAcGFyYW0gY29sdW1uIENvbHVtbiBwYXRoLlxuXHQgKiBAcGFyYW0gY29sdW1uQWxpYXMgQ29sdW1uIGFsaWFzLlxuXHQgKiBAcmV0dXJucyBbQmFzZVF1ZXJ5Q29sdW1uXSBDb2x1bW4gaW5zdGFuY2UuXG5cdCAqL1xuXHRwdWJsaWMgYWRkQ29sdW1uKGNvbHVtbjogybVCYXNlUXVlcnlDb2x1bW4sIGNvbHVtbkFsaWFzOiBzdHJpbmcpOiDJtUJhc2VRdWVyeUNvbHVtbiB7XG5cdFx0dGhpcy5faW50ZXJuYWxBZGRDb2x1bW4oY29sdW1uQWxpYXMsIGNvbHVtbik7XG5cdFx0cmV0dXJuIGNvbHVtbjtcblx0fVxuXG5cdC8qKlxuXHQgKiBBZGQgY29sdW1uIGJ5IGNvbHVtbiBwYXRoLlxuXHQgKiBAcGFyYW0gY29sdW1uUGF0aCBDb2x1bW4gcGF0aC5cblx0ICogQHBhcmFtIGNvbHVtbkFsaWFzIENvbHVtbiBhbGlhcy5cblx0ICogQHJldHVybnMgW0VudGl0eVF1ZXJ5Q29sdW1uXSBDb2x1bW4gaW5zdGFuY2UuXG5cdCAqL1xuXHRwdWJsaWMgYWRkU2NoZW1hQ29sdW1uKGNvbHVtblBhdGg6IHN0cmluZywgY29sdW1uQWxpYXM/OiBzdHJpbmcpOiDJtUVudGl0eVF1ZXJ5Q29sdW1uIHtcblx0XHTJtVZhbGlkYXRpb25VdGlsaXRpZXMuY2hlY2tBcmd1bWVudEVtcHR5KCdjb2x1bW5QYXRoJywgY29sdW1uUGF0aCk7XG5cdFx0Y29uc3QgY29sdW1uID0gbmV3IMm1RW50aXR5UXVlcnlDb2x1bW4oY29sdW1uUGF0aCk7XG5cdFx0dGhpcy5faW50ZXJuYWxBZGRDb2x1bW4oY29sdW1uQWxpYXMgfHwgY29sdW1uUGF0aCwgY29sdW1uKTtcblx0XHRyZXR1cm4gY29sdW1uO1xuXHR9XG5cblx0LyoqXG5cdCAqIEFkZCBhZ2dyZWdhdGlvbiBzdWIgcXVlcnkgY29sdW1uLlxuXHQgKiBAcGFyYW0gY29sdW1uUGF0aCBDb2x1bW4gcGF0aC5cblx0ICogQHBhcmFtIGFnZ3JlZ2F0aW9uVHlwZSBBZ2dyZWdhdGlvbiB0eXBlLlxuXHQgKiBAcGFyYW0gc3ViRmlsdGVycyBTdWIgcXVlcnkgZmlsdGVycy5cblx0ICogQHBhcmFtIGNvbHVtbkFsaWFzIENvbHVtbiBhbGlhcy5cblx0ICogQHJldHVybnMgW0FnZ3JlZ2F0aW9uU3ViUXVlcnlDb2x1bW5dIENvbHVtbiBpbnN0YW5jZS5cblx0ICovXG5cdHB1YmxpYyBhZGRBZ2dyZWdhdGlvblN1YlF1ZXJ5Q29sdW1uKFxuXHRcdGNvbHVtblBhdGg6IHN0cmluZyxcblx0XHRhZ2dyZWdhdGlvblR5cGU6IMm1QWdncmVnYXRpb25UeXBlLFxuXHRcdGFnZ3JlZ2F0aW9uQ29uZmlnOiDJtURhdGFTb3VyY2VBZ2dyZWdhdGlvbkNvbmZpZyxcblx0XHRjb2x1bW5BbGlhcz86IHN0cmluZyxcblx0KTogybVBZ2dyZWdhdGlvblN1YlF1ZXJ5Q29sdW1uIHtcblx0XHRjb25zdCBjb2x1bW4gPSBuZXcgybVBZ2dyZWdhdGlvblN1YlF1ZXJ5Q29sdW1uKFxuXHRcdFx0Y29sdW1uUGF0aCxcblx0XHRcdGFnZ3JlZ2F0aW9uVHlwZSxcblx0XHRcdGFnZ3JlZ2F0aW9uQ29uZmlnLmZpbHRlcixcblx0XHRcdGFnZ3JlZ2F0aW9uQ29uZmlnLnNvcnRCeURpcmVjdGlvbixcblx0XHRcdGFnZ3JlZ2F0aW9uQ29uZmlnLnNvcnRCeUNvbHVtbixcblx0XHQpO1xuXHRcdHRoaXMuX2ludGVybmFsQWRkQ29sdW1uKGNvbHVtbkFsaWFzIHx8IGNvbHVtblBhdGgsIGNvbHVtbik7XG5cdFx0cmV0dXJuIGNvbHVtbjtcblx0fVxuXG5cdC8qKlxuXHQgKiBBZGQgcGFyYW1ldGVyIGNvbHVtbi5cblx0ICogQHBhcmFtIHZhbHVlIFBhcmFtZXRlciB2YWx1ZS5cblx0ICogQHBhcmFtIGRhdGFWYWx1ZVR5cGUgUGFyYW1ldGVyIGRhdGEgdmFsdWUgdHlwZS5cblx0ICogQHBhcmFtIGNvbHVtbkFsaWFzIENvbHVtbiBhbGlhcy5cblx0ICogQHJldHVybnMgW1BhcmFtZXRlclF1ZXJ5Q29sdW1uXSBDb2x1bW4gaW5zdGFuY2UuXG5cdCAqL1xuXHRwdWJsaWMgYWRkUGFyYW1ldGVyQ29sdW1uKFxuXHRcdHZhbHVlOiDJtUVudGl0eUNvbHVtblZhbHVlLFxuXHRcdGRhdGFWYWx1ZVR5cGU6IMm1RGF0YVZhbHVlVHlwZSxcblx0XHRjb2x1bW5BbGlhczogc3RyaW5nLFxuXHQpOiDJtVBhcmFtZXRlclF1ZXJ5Q29sdW1uIHtcblx0XHRjb25zdCBjb2x1bW4gPSBuZXcgybVQYXJhbWV0ZXJRdWVyeUNvbHVtbih2YWx1ZSwgZGF0YVZhbHVlVHlwZSk7XG5cdFx0dGhpcy5faW50ZXJuYWxBZGRDb2x1bW4oY29sdW1uQWxpYXMsIGNvbHVtbik7XG5cdFx0cmV0dXJuIGNvbHVtbjtcblx0fVxuXG5cdC8qKlxuXHQgKiBBZGQgYXJpdGhtZXRpYyBjb2x1bW4uXG5cdCAqIEBwYXJhbSBhcml0aG1ldGljT3BlcmF0aW9uIEFyaXRobWV0aWMgb3BlcmF0aW9uLlxuXHQgKiBAcGFyYW0gbGVmdEFyaXRobWV0aWNPcGVyYW5kIExlZnQgYXJpdGhtZXRpYyBvcGVyYW5kIGV4cHJlc3Npb24uXG5cdCAqIEBwYXJhbSByaWdodEFyaXRobWV0aWNPcGVyYW5kIFJpZ2h0IGFyaXRobWV0aWMgb3BlcmFuZCBleHByZXNzaW9uLlxuXHQgKiBAcGFyYW0gY29sdW1uQWxpYXMgQ29sdW1uIGFsaWFzLlxuXHQgKiBAcmV0dXJucyBbQXJpdGhtZXRpY1F1ZXJ5Q29sdW1uXSBDb2x1bW4gaW5zdGFuY2UuXG5cdCAqL1xuXHRwdWJsaWMgYWRkQXJpdGhtZXRpY0NvbHVtbihcblx0XHRhcml0aG1ldGljT3BlcmF0aW9uOiDJtUFyaXRobWV0aWNPcGVyYXRpb24sXG5cdFx0bGVmdEFyaXRobWV0aWNPcGVyYW5kOiDJtUJhc2VFeHByZXNzaW9uLFxuXHRcdHJpZ2h0QXJpdGhtZXRpY09wZXJhbmQ6IMm1QmFzZUV4cHJlc3Npb24sXG5cdFx0Y29sdW1uQWxpYXM6IHN0cmluZyxcblx0KTogybVBcml0aG1ldGljUXVlcnlDb2x1bW4ge1xuXHRcdGNvbnN0IGNvbHVtbiA9IG5ldyDJtUFyaXRobWV0aWNRdWVyeUNvbHVtbihhcml0aG1ldGljT3BlcmF0aW9uLCBsZWZ0QXJpdGhtZXRpY09wZXJhbmQsIHJpZ2h0QXJpdGhtZXRpY09wZXJhbmQpO1xuXHRcdHRoaXMuX2ludGVybmFsQWRkQ29sdW1uKGNvbHVtbkFsaWFzLCBjb2x1bW4pO1xuXHRcdHJldHVybiBjb2x1bW47XG5cdH1cblxuXHQvKipcblx0ICogQWRkIG1hY3JvcyBmdW5jdGlvbiBjb2x1bW4uXG5cdCAqIEBwYXJhbSBxdWVyeU1hY3Jvc1R5cGUgTWFjcm9zIHR5cGUuXG5cdCAqIEBwYXJhbSBjb2x1bW5BbGlhcyBDb2x1bW4gYWxpYXMuXG5cdCAqIEByZXR1cm5zIFtNYWNyb3NGdW5jdGlvbkNvbHVtbl0gQ29sdW1uIGluc3RhbmNlLlxuXHQgKi9cblx0cHVibGljIGFkZE1hY3Jvc0Z1bmN0aW9uQ29sdW1uKHF1ZXJ5TWFjcm9zVHlwZTogybVRdWVyeU1hY3Jvc1R5cGUsIGNvbHVtbkFsaWFzOiBzdHJpbmcpOiDJtU1hY3Jvc0Z1bmN0aW9uQ29sdW1uIHtcblx0XHRjb25zdCBjb2x1bW4gPSBuZXcgybVNYWNyb3NGdW5jdGlvbkNvbHVtbihxdWVyeU1hY3Jvc1R5cGUpO1xuXHRcdHRoaXMuX2ludGVybmFsQWRkQ29sdW1uKGNvbHVtbkFsaWFzLCBjb2x1bW4pO1xuXHRcdHJldHVybiBjb2x1bW47XG5cdH1cblxuXHQvKipcblx0ICogQWRkIGRhdGUgcGFydCBmdW5jdGlvbiBjb2x1bW4uXG5cdCAqIEBwYXJhbSBjb2x1bW5QYXRoIENvbHVtbiBwYXRoLlxuXHQgKiBAcGFyYW0gZGF0ZVBhcnRUeXBlIERhdGUgcGFydCB0eXBlLlxuXHQgKiBAcGFyYW0gY29sdW1uQWxpYXMgQ29sdW1uIGFsaWFzLlxuXHQgKiBAcmV0dXJucyBbRGF0ZVBhcnRGdW5jdGlvbkNvbHVtbl0gQ29sdW1uIGluc3RhbmNlLlxuXHQgKi9cblx0cHVibGljIGFkZERhdGVQYXJ0RnVuY3Rpb25Db2x1bW4oXG5cdFx0Y29sdW1uUGF0aDogc3RyaW5nLFxuXHRcdGRhdGVQYXJ0VHlwZTogybVEYXRlUGFydFR5cGUsXG5cdFx0Y29sdW1uQWxpYXM6IHN0cmluZyxcblx0KTogybVEYXRlUGFydEZ1bmN0aW9uQ29sdW1uIHtcblx0XHRjb25zdCBmdW5jdGlvbkFyZ3VtZW50ID0gbmV3IMm1Q29sdW1uRXhwcmVzc2lvbih7Y29sdW1uUGF0aH0pO1xuXHRcdGNvbnN0IGNvbHVtbiA9IG5ldyDJtURhdGVQYXJ0RnVuY3Rpb25Db2x1bW4oZGF0ZVBhcnRUeXBlLCBmdW5jdGlvbkFyZ3VtZW50KTtcblx0XHR0aGlzLl9pbnRlcm5hbEFkZENvbHVtbihjb2x1bW5BbGlhcywgY29sdW1uKTtcblx0XHRyZXR1cm4gY29sdW1uO1xuXHR9XG5cblx0LyoqXG5cdCAqIEFkZCBhZ2dyZWdhdGlvbiBmdW5jdGlvbiBjb2x1bW4uXG5cdCAqIEBwYXJhbSBjb2x1bW5QYXRoIENvbHVtbiBwYXRoLlxuXHQgKiBAcGFyYW0gYWdncmVnYXRpb25UeXBlIEFnZ3JlZ2F0aW9uIHR5cGUuXG5cdCAqIEBwYXJhbSBjb2x1bW5BbGlhcyBDb2x1bW4gYWxpYXMuXG5cdCAqIEBwYXJhbSBhZ2dyZWdhdGlvbkV2YWxUeXBlIEFnZ3JlZ2F0aW9uIGV2YWwgdHlwZS5cblx0ICogQHJldHVybnMgW0FnZ3JlZ2F0aW9uRnVuY3Rpb25Db2x1bW5dIENvbHVtbiBpbnN0YW5jZS5cblx0ICovXG5cdHB1YmxpYyBhZGRBZ2dyZWdhdGlvbkZ1bmN0aW9uQ29sdW1uKFxuXHRcdGNvbHVtblBhdGg6IHN0cmluZyxcblx0XHRhZ2dyZWdhdGlvblR5cGU6IMm1QWdncmVnYXRpb25UeXBlLFxuXHRcdGNvbHVtbkFsaWFzOiBzdHJpbmcsXG5cdFx0YWdncmVnYXRpb25FdmFsVHlwZTogybVBZ2dyZWdhdGlvbkV2YWxUeXBlID0gybVBZ2dyZWdhdGlvbkV2YWxUeXBlLk5vbmUsXG5cdCk6IMm1QWdncmVnYXRpb25GdW5jdGlvbkNvbHVtbiB7XG5cdFx0Y29uc3QgZnVuY3Rpb25Bcmd1bWVudCA9IG5ldyDJtUNvbHVtbkV4cHJlc3Npb24oe2NvbHVtblBhdGh9KTtcblx0XHRjb25zdCBjb2x1bW4gPSBuZXcgybVBZ2dyZWdhdGlvbkZ1bmN0aW9uQ29sdW1uKGFnZ3JlZ2F0aW9uVHlwZSwgYWdncmVnYXRpb25FdmFsVHlwZSwgZnVuY3Rpb25Bcmd1bWVudCk7XG5cdFx0dGhpcy5faW50ZXJuYWxBZGRDb2x1bW4oY29sdW1uQWxpYXMsIGNvbHVtbik7XG5cdFx0cmV0dXJuIGNvbHVtbjtcblx0fVxuXG5cdC8qKlxuXHQgKiBBZGQgbGVuZ3RoIGZ1bmN0aW9uIGNvbHVtbi5cblx0ICogQHBhcmFtIGNvbHVtblBhdGggQ29sdW1uIHBhdGguXG5cdCAqIEBwYXJhbSBjb2x1bW5BbGlhcyBDb2x1bW4gYWxpYXMuXG5cdCAqIEByZXR1cm5zIFtMZW5ndGhGdW5jdGlvbkNvbHVtbl0gQ29sdW1uIGluc3RhbmNlLlxuXHQgKi9cblx0cHVibGljIGFkZExlbmd0aEZ1bmN0aW9uQ29sdW1uKGNvbHVtblBhdGg6IHN0cmluZywgY29sdW1uQWxpYXM6IHN0cmluZyk6IMm1TGVuZ3RoRnVuY3Rpb25Db2x1bW4ge1xuXHRcdGNvbnN0IGZ1bmN0aW9uQXJndW1lbnQgPSBuZXcgybVDb2x1bW5FeHByZXNzaW9uKHtjb2x1bW5QYXRofSk7XG5cdFx0Y29uc3QgY29sdW1uID0gbmV3IMm1TGVuZ3RoRnVuY3Rpb25Db2x1bW4oZnVuY3Rpb25Bcmd1bWVudCk7XG5cdFx0dGhpcy5faW50ZXJuYWxBZGRDb2x1bW4oY29sdW1uQWxpYXMsIGNvbHVtbik7XG5cdFx0cmV0dXJuIGNvbHVtbjtcblx0fVxuXG5cdC8qKlxuXHQgKiBBZGQgd2luZG93IGZ1bmN0aW9uIGNvbHVtbi5cblx0ICogQHBhcmFtIGNvbHVtblBhdGggQ29sdW1uIHBhdGguXG5cdCAqIEBwYXJhbSBhZ2dyZWdhdGlvblR5cGUgQWdncmVnYXRpb24gdHlwZS5cblx0ICogQHBhcmFtIGNvbHVtbkFsaWFzIENvbHVtbiBhbGlhcy5cblx0ICogQHBhcmFtIGFnZ3JlZ2F0aW9uRXZhbFR5cGUgQWdncmVnYXRpb24gZXZhbCB0eXBlLlxuXHQgKiBAcmV0dXJucyBbV2luZG93RnVuY3Rpb25Db2x1bW5dIENvbHVtbiBpbnN0YW5jZS5cblx0ICovXG5cdHB1YmxpYyBhZGRXaW5kb3dGdW5jdGlvbkNvbHVtbihcblx0XHRjb2x1bW5QYXRoOiBzdHJpbmcsXG5cdFx0YWdncmVnYXRpb25UeXBlOiDJtUFnZ3JlZ2F0aW9uVHlwZSxcblx0XHRjb2x1bW5BbGlhczogc3RyaW5nLFxuXHRcdGFnZ3JlZ2F0aW9uRXZhbFR5cGU6IMm1QWdncmVnYXRpb25FdmFsVHlwZSA9IMm1QWdncmVnYXRpb25FdmFsVHlwZS5Ob25lLFxuXHQpOiDJtVdpbmRvd0Z1bmN0aW9uQ29sdW1uIHtcblx0XHRjb25zdCBmdW5jdGlvbkFyZ3VtZW50ID0gbmV3IMm1QWdncmVnYXRpb25GdW5jdGlvbkV4cHJlc3Npb24oe1xuXHRcdFx0YWdncmVnYXRpb25UeXBlLFxuXHRcdFx0YWdncmVnYXRpb25FdmFsVHlwZSxcblx0XHRcdGZ1bmN0aW9uQXJndW1lbnQ6IG5ldyDJtUNvbHVtbkV4cHJlc3Npb24oe2NvbHVtblBhdGh9KSxcblx0XHR9KTtcblx0XHRjb25zdCBjb2x1bW4gPSBuZXcgybVXaW5kb3dGdW5jdGlvbkNvbHVtbihmdW5jdGlvbkFyZ3VtZW50KTtcblx0XHR0aGlzLl9pbnRlcm5hbEFkZENvbHVtbihjb2x1bW5BbGlhcywgY29sdW1uKTtcblx0XHRyZXR1cm4gY29sdW1uO1xuXHR9XG59XG4iXX0=