{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Lenovo/Desktop/Word_viewer/Word_viewer/projects/word_viewer/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate, __metadata } from \"tslib\";\nimport { EventEmitter } from \"@angular/core\";\nimport { CrtInterfaceDesignerItem, CrtViewElement, CrtInput, CrtOutput } from \"@creatio-devkit/common\";\nimport * as mammoth from 'mammoth';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nfunction WordViewerComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 7);\n    i0.ɵɵtext(1, \" Loading document... \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction WordViewerComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.error, \" \");\n  }\n}\nfunction WordViewerComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 9)(1, \"div\", 10);\n    i0.ɵɵelement(2, \"div\", 11);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"innerHTML\", ctx_r2.convertedHtml, i0.ɵɵsanitizeHtml);\n  }\n}\nlet WordViewerComponent = class WordViewerComponent {\n  constructor() {\n    this._documentUrl = '';\n    this._documentContent = '';\n    this._attachmentId = '';\n    this._schemaName = '';\n    this.loadingStateChange = new EventEmitter();\n    this.errorChange = new EventEmitter();\n    this.isLoading = false;\n    this.error = null;\n    this.currentDate = new Date();\n    this.convertedHtml = '';\n  }\n  set documentUrl(value) {\n    console.log('Document URL received:', value);\n    this._documentUrl = value || '';\n    this.loadDocument();\n  }\n  get documentUrl() {\n    return this._documentUrl;\n  }\n  set documentContent(value) {\n    console.log('Document content received:', value);\n    this._documentContent = value || '';\n    this.loadDocument();\n  }\n  get documentContent() {\n    return this._documentContent;\n  }\n  set attachmentId(value) {\n    console.log('Attachment ID received:', value);\n    this._attachmentId = value || '';\n    if (this._attachmentId && this._schemaName) {\n      this.loadAttachment();\n    }\n  }\n  get attachmentId() {\n    return this._attachmentId;\n  }\n  set schemaName(value) {\n    console.log('Schema name received:', value);\n    this._schemaName = value || '';\n    if (this._attachmentId && this._schemaName) {\n      this.loadAttachment();\n    }\n  }\n  get schemaName() {\n    return this._schemaName;\n  }\n  ngOnInit() {\n    console.log('Component initialized with:', {\n      documentUrl: this.documentUrl,\n      documentContent: this.documentContent,\n      attachmentId: this.attachmentId,\n      schemaName: this.schemaName\n    });\n  }\n  setLoading(loading) {\n    this.isLoading = loading;\n    this.loadingStateChange.emit(loading);\n  }\n  setError(error) {\n    this.error = error;\n    if (error) {\n      this.errorChange.emit(error);\n    }\n  }\n  loadAttachment() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      if (!_this.attachmentId || !_this.schemaName) {\n        _this.setError(\"Attachment ID or Schema Name not provided\");\n        return;\n      }\n      try {\n        _this.setLoading(true);\n        // Here implement the attachment loading logic using Creatio services\n        // This would typically involve querying the attachment and setting documentContent\n        _this.setLoading(false);\n      } catch (err) {\n        _this.setError(\"Failed to load attachment\");\n        _this.setLoading(false);\n      }\n    })();\n  }\n  loadDocument() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this2.documentUrl && !_this2.documentContent) {\n        _this2.setError(\"No document provided\");\n        return;\n      }\n      try {\n        _this2.setLoading(true);\n        if (_this2.documentContent) {\n          // Convert base64 string to ArrayBuffer\n          const binaryString = window.atob(_this2.documentContent);\n          const bytes = new Uint8Array(binaryString.length);\n          for (let i = 0; i < binaryString.length; i++) {\n            bytes[i] = binaryString.charCodeAt(i);\n          }\n          const result = yield mammoth.convertToHtml({\n            arrayBuffer: bytes.buffer\n          });\n          _this2.convertedHtml = result.value;\n        } else if (_this2.documentUrl) {\n          const response = yield fetch(_this2.documentUrl);\n          const arrayBuffer = yield response.arrayBuffer();\n          const result = yield mammoth.convertToHtml({\n            arrayBuffer\n          });\n          _this2.convertedHtml = result.value;\n        }\n        _this2.setLoading(false);\n      } catch (err) {\n        console.error('Document conversion error:', err);\n        _this2.setError(\"Failed to load document\");\n        _this2.setLoading(false);\n      }\n    })();\n  }\n  static {\n    this.ɵfac = function WordViewerComponent_Factory(t) {\n      return new (t || WordViewerComponent)();\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: WordViewerComponent,\n      selectors: [[\"qnovate-word-viewer\"]],\n      inputs: {\n        documentUrl: \"documentUrl\",\n        documentContent: \"documentContent\",\n        attachmentId: \"attachmentId\",\n        schemaName: \"schemaName\"\n      },\n      outputs: {\n        loadingStateChange: \"loadingStateChange\",\n        errorChange: \"errorChange\"\n      },\n      decls: 8,\n      vars: 4,\n      consts: [[1, \"word-viewer-container\"], [1, \"toolbar\"], [3, \"disabled\", \"click\"], [1, \"content-area\"], [\"class\", \"loading\", 4, \"ngIf\"], [\"class\", \"error\", 4, \"ngIf\"], [\"class\", \"document-content\", 4, \"ngIf\"], [1, \"loading\"], [1, \"error\"], [1, \"document-content\"], [1, \"page\"], [3, \"innerHTML\"]],\n      template: function WordViewerComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"button\", 2);\n          i0.ɵɵlistener(\"click\", function WordViewerComponent_Template_button_click_2_listener() {\n            return ctx.loadDocument();\n          });\n          i0.ɵɵtext(3, \" Load Document \");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(4, \"div\", 3);\n          i0.ɵɵtemplate(5, WordViewerComponent_div_5_Template, 2, 0, \"div\", 4);\n          i0.ɵɵtemplate(6, WordViewerComponent_div_6_Template, 2, 1, \"div\", 5);\n          i0.ɵɵtemplate(7, WordViewerComponent_div_7_Template, 3, 1, \"div\", 6);\n          i0.ɵɵelementEnd()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"disabled\", ctx.isLoading);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.error);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", !ctx.isLoading && !ctx.error);\n        }\n      },\n      dependencies: [i1.NgIf],\n      styles: [\".word-viewer-container {\\n  display: flex;\\n  flex-direction: column;\\n  height: 100%;\\n  width: 100%;\\n  background: #f5f5f5;\\n}\\n.word-viewer-container .toolbar {\\n  padding: 12px;\\n  background: #fff;\\n  border-bottom: 1px solid #e0e0e0;\\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\\n}\\n.word-viewer-container .toolbar button {\\n  padding: 8px 16px;\\n  background: #007bff;\\n  color: white;\\n  border: none;\\n  border-radius: 4px;\\n  cursor: pointer;\\n  font-size: 14px;\\n}\\n.word-viewer-container .toolbar button:disabled {\\n  background: #cccccc;\\n}\\n.word-viewer-container .toolbar button:hover:not(:disabled) {\\n  background: #0056b3;\\n}\\n.word-viewer-container .content-area {\\n  flex: 1;\\n  padding: 24px;\\n  overflow-y: auto;\\n}\\n.word-viewer-container .content-area .loading {\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n  height: 200px;\\n  font-size: 16px;\\n  color: #666;\\n}\\n.word-viewer-container .content-area .error {\\n  color: #dc3545;\\n  padding: 16px;\\n  text-align: center;\\n  background: #f8d7da;\\n  border-radius: 4px;\\n  margin: 16px;\\n}\\n.word-viewer-container .content-area .document-content .page {\\n  background: white;\\n  padding: 48px;\\n  margin: 0 auto;\\n  max-width: 816px;\\n  min-height: 1056px;\\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\\n}\\n.word-viewer-container .content-area .document-content .page .page-header {\\n  margin-bottom: 32px;\\n  padding-bottom: 16px;\\n  border-bottom: 1px solid #eee;\\n}\\n.word-viewer-container .content-area .document-content .page .page-header h1 {\\n  margin: 0 0 16px 0;\\n  color: #333;\\n  font-size: 24px;\\n}\\n.word-viewer-container .content-area .document-content .page .page-header .metadata {\\n  color: #666;\\n  font-size: 12px;\\n}\\n.word-viewer-container .content-area .document-content .page .page-content h2 {\\n  color: #444;\\n  margin: 24px 0 16px;\\n  font-size: 18px;\\n}\\n.word-viewer-container .content-area .document-content .page .page-content p {\\n  margin: 0 0 16px;\\n  line-height: 1.6;\\n  color: #333;\\n}\\n.word-viewer-container .content-area .document-content .page .page-content ul {\\n  margin: 16px 0;\\n  padding-left: 24px;\\n}\\n.word-viewer-container .content-area .document-content .page .page-content ul li {\\n  margin: 8px 0;\\n  color: #333;\\n}\\n.word-viewer-container .content-area .document-content .page .page-content .custom-content {\\n  margin-top: 32px;\\n  padding-top: 16px;\\n  border-top: 1px solid #eee;\\n}\\n.word-viewer-container .content-area .document-content .page .page-footer {\\n  margin-top: 32px;\\n  padding-top: 16px;\\n  border-top: 1px solid #eee;\\n  text-align: center;\\n  color: #666;\\n  font-size: 12px;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvdmlldy1lbGVtZW50cy93b3JkLXZpZXdlci93b3JkLXZpZXdlci5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGFBQUE7RUFDQSxzQkFBQTtFQUNBLFlBQUE7RUFDQSxXQUFBO0VBQ0EsbUJBQUE7QUFDRjtBQUNFO0VBQ0UsYUFBQTtFQUNBLGdCQUFBO0VBQ0EsZ0NBQUE7RUFDQSx3Q0FBQTtBQUNKO0FBQ0k7RUFDRSxpQkFBQTtFQUNBLG1CQUFBO0VBQ0EsWUFBQTtFQUNBLFlBQUE7RUFDQSxrQkFBQTtFQUNBLGVBQUE7RUFDQSxlQUFBO0FBQ047QUFDTTtFQUNFLG1CQUFBO0FBQ1I7QUFFTTtFQUNFLG1CQUFBO0FBQVI7QUFLRTtFQUNFLE9BQUE7RUFDQSxhQUFBO0VBQ0EsZ0JBQUE7QUFISjtBQUtJO0VBQ0UsYUFBQTtFQUNBLHVCQUFBO0VBQ0EsbUJBQUE7RUFDQSxhQUFBO0VBQ0EsZUFBQTtFQUNBLFdBQUE7QUFITjtBQU1JO0VBQ0UsY0FBQTtFQUNBLGFBQUE7RUFDQSxrQkFBQTtFQUNBLG1CQUFBO0VBQ0Esa0JBQUE7RUFDQSxZQUFBO0FBSk47QUFRTTtFQUNFLGlCQUFBO0VBQ0EsYUFBQTtFQUNBLGNBQUE7RUFDQSxnQkFBQTtFQUNBLGtCQUFBO0VBQ0EseUNBQUE7QUFOUjtBQVFRO0VBQ0UsbUJBQUE7RUFDQSxvQkFBQTtFQUNBLDZCQUFBO0FBTlY7QUFRVTtFQUNFLGtCQUFBO0VBQ0EsV0FBQTtFQUNBLGVBQUE7QUFOWjtBQVNVO0VBQ0UsV0FBQTtFQUNBLGVBQUE7QUFQWjtBQVlVO0VBQ0UsV0FBQTtFQUNBLG1CQUFBO0VBQ0EsZUFBQTtBQVZaO0FBYVU7RUFDRSxnQkFBQTtFQUNBLGdCQUFBO0VBQ0EsV0FBQTtBQVhaO0FBY1U7RUFDRSxjQUFBO0VBQ0Esa0JBQUE7QUFaWjtBQWNZO0VBQ0UsYUFBQTtFQUNBLFdBQUE7QUFaZDtBQWdCVTtFQUNFLGdCQUFBO0VBQ0EsaUJBQUE7RUFDQSwwQkFBQTtBQWRaO0FBa0JRO0VBQ0UsZ0JBQUE7RUFDQSxpQkFBQTtFQUNBLDBCQUFBO0VBQ0Esa0JBQUE7RUFDQSxXQUFBO0VBQ0EsZUFBQTtBQWhCViIsInNvdXJjZXNDb250ZW50IjpbIi53b3JkLXZpZXdlci1jb250YWluZXIge1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICBoZWlnaHQ6IDEwMCU7XHJcbiAgd2lkdGg6IDEwMCU7XHJcbiAgYmFja2dyb3VuZDogI2Y1ZjVmNTtcclxuICBcclxuICAudG9vbGJhciB7XHJcbiAgICBwYWRkaW5nOiAxMnB4O1xyXG4gICAgYmFja2dyb3VuZDogI2ZmZjtcclxuICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZTBlMGUwO1xyXG4gICAgYm94LXNoYWRvdzogMCAycHggNHB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcclxuXHJcbiAgICBidXR0b24ge1xyXG4gICAgICBwYWRkaW5nOiA4cHggMTZweDtcclxuICAgICAgYmFja2dyb3VuZDogIzAwN2JmZjtcclxuICAgICAgY29sb3I6IHdoaXRlO1xyXG4gICAgICBib3JkZXI6IG5vbmU7XHJcbiAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcclxuICAgICAgY3Vyc29yOiBwb2ludGVyO1xyXG4gICAgICBmb250LXNpemU6IDE0cHg7XHJcblxyXG4gICAgICAmOmRpc2FibGVkIHtcclxuICAgICAgICBiYWNrZ3JvdW5kOiAjY2NjY2NjO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAmOmhvdmVyOm5vdCg6ZGlzYWJsZWQpIHtcclxuICAgICAgICBiYWNrZ3JvdW5kOiAjMDA1NmIzO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAuY29udGVudC1hcmVhIHtcclxuICAgIGZsZXg6IDE7XHJcbiAgICBwYWRkaW5nOiAyNHB4O1xyXG4gICAgb3ZlcmZsb3cteTogYXV0bztcclxuXHJcbiAgICAubG9hZGluZyB7XHJcbiAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG4gICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gICAgICBoZWlnaHQ6IDIwMHB4O1xyXG4gICAgICBmb250LXNpemU6IDE2cHg7XHJcbiAgICAgIGNvbG9yOiAjNjY2O1xyXG4gICAgfVxyXG5cclxuICAgIC5lcnJvciB7XHJcbiAgICAgIGNvbG9yOiAjZGMzNTQ1O1xyXG4gICAgICBwYWRkaW5nOiAxNnB4O1xyXG4gICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbiAgICAgIGJhY2tncm91bmQ6ICNmOGQ3ZGE7XHJcbiAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcclxuICAgICAgbWFyZ2luOiAxNnB4O1xyXG4gICAgfVxyXG5cclxuICAgIC5kb2N1bWVudC1jb250ZW50IHtcclxuICAgICAgLnBhZ2Uge1xyXG4gICAgICAgIGJhY2tncm91bmQ6IHdoaXRlO1xyXG4gICAgICAgIHBhZGRpbmc6IDQ4cHg7XHJcbiAgICAgICAgbWFyZ2luOiAwIGF1dG87XHJcbiAgICAgICAgbWF4LXdpZHRoOiA4MTZweDsgLy8gU3RhbmRhcmQgVVMgTGV0dGVyIHdpZHRoXHJcbiAgICAgICAgbWluLWhlaWdodDogMTA1NnB4OyAvLyBTdGFuZGFyZCBVUyBMZXR0ZXIgaGVpZ2h0XHJcbiAgICAgICAgYm94LXNoYWRvdzogMCAycHggOHB4IHJnYmEoMCwgMCwgMCwgMC4xNSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLnBhZ2UtaGVhZGVyIHtcclxuICAgICAgICAgIG1hcmdpbi1ib3R0b206IDMycHg7XHJcbiAgICAgICAgICBwYWRkaW5nLWJvdHRvbTogMTZweDtcclxuICAgICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZWVlO1xyXG5cclxuICAgICAgICAgIGgxIHtcclxuICAgICAgICAgICAgbWFyZ2luOiAwIDAgMTZweCAwO1xyXG4gICAgICAgICAgICBjb2xvcjogIzMzMztcclxuICAgICAgICAgICAgZm9udC1zaXplOiAyNHB4O1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC5tZXRhZGF0YSB7XHJcbiAgICAgICAgICAgIGNvbG9yOiAjNjY2O1xyXG4gICAgICAgICAgICBmb250LXNpemU6IDEycHg7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAucGFnZS1jb250ZW50IHtcclxuICAgICAgICAgIGgyIHtcclxuICAgICAgICAgICAgY29sb3I6ICM0NDQ7XHJcbiAgICAgICAgICAgIG1hcmdpbjogMjRweCAwIDE2cHg7XHJcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMThweDtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBwIHtcclxuICAgICAgICAgICAgbWFyZ2luOiAwIDAgMTZweDtcclxuICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDEuNjtcclxuICAgICAgICAgICAgY29sb3I6ICMzMzM7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgdWwge1xyXG4gICAgICAgICAgICBtYXJnaW46IDE2cHggMDtcclxuICAgICAgICAgICAgcGFkZGluZy1sZWZ0OiAyNHB4O1xyXG5cclxuICAgICAgICAgICAgbGkge1xyXG4gICAgICAgICAgICAgIG1hcmdpbjogOHB4IDA7XHJcbiAgICAgICAgICAgICAgY29sb3I6ICMzMzM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAuY3VzdG9tLWNvbnRlbnQge1xyXG4gICAgICAgICAgICBtYXJnaW4tdG9wOiAzMnB4O1xyXG4gICAgICAgICAgICBwYWRkaW5nLXRvcDogMTZweDtcclxuICAgICAgICAgICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkICNlZWU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAucGFnZS1mb290ZXIge1xyXG4gICAgICAgICAgbWFyZ2luLXRvcDogMzJweDtcclxuICAgICAgICAgIHBhZGRpbmctdG9wOiAxNnB4O1xyXG4gICAgICAgICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkICNlZWU7XHJcbiAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbiAgICAgICAgICBjb2xvcjogIzY2NjtcclxuICAgICAgICAgIGZvbnQtc2l6ZTogMTJweDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn0iXSwic291cmNlUm9vdCI6IiJ9 */\"],\n      encapsulation: 3\n    });\n  }\n};\n__decorate([CrtInput(), __metadata(\"design:type\", String), __metadata(\"design:paramtypes\", [String])], WordViewerComponent.prototype, \"documentUrl\", null);\n__decorate([CrtInput(), __metadata(\"design:type\", String), __metadata(\"design:paramtypes\", [String])], WordViewerComponent.prototype, \"documentContent\", null);\n__decorate([CrtInput(), __metadata(\"design:type\", String), __metadata(\"design:paramtypes\", [String])], WordViewerComponent.prototype, \"attachmentId\", null);\n__decorate([CrtInput(), __metadata(\"design:type\", String), __metadata(\"design:paramtypes\", [String])], WordViewerComponent.prototype, \"schemaName\", null);\n__decorate([CrtOutput(), __metadata(\"design:type\", Object)], WordViewerComponent.prototype, \"loadingStateChange\", void 0);\n__decorate([CrtOutput(), __metadata(\"design:type\", Object)], WordViewerComponent.prototype, \"errorChange\", void 0);\nWordViewerComponent = __decorate([CrtViewElement({\n  selector: \"qnovate-word-viewer\",\n  type: \"qnovate.WordViewer\"\n}), CrtInterfaceDesignerItem({\n  toolbarConfig: {\n    caption: \"Word Viewer\",\n    name: \"qnovate-word-viewer\",\n    icon: require(\"!!raw-loader?{esModule:false}!./word-viewer-icon.svg\")\n  }\n})], WordViewerComponent);\nexport { WordViewerComponent };","map":{"version":3,"mappings":"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","names":["EventEmitter","CrtInterfaceDesignerItem","CrtViewElement","CrtInput","CrtOutput","mammoth","i0","WordViewerComponent","constructor","Date","documentUrl","value","console","log","_documentUrl","loadDocument","documentContent","_documentContent","attachmentId","_attachmentId","_schemaName","loadAttachment","schemaName","ngOnInit","setLoading","loading","isLoading","loadingStateChange","emit","setError","error","errorChange","err","binaryString","window","atob","bytes","Uint8Array","length","i","charCodeAt","result","convertToHtml","arrayBuffer","buffer","convertedHtml","response","fetch","selectors","inputs","outputs","decls","vars","consts","template","ctx","__decorate","selector","type","toolbarConfig","caption","name","icon","require"],"sourceRoot":"","sources":["C:\\Users\\Lenovo\\Desktop\\Word_viewer\\Word_viewer\\projects\\word_viewer\\src\\app\\view-elements\\word-viewer\\word-viewer.component.ts","C:\\Users\\Lenovo\\Desktop\\Word_viewer\\Word_viewer\\projects\\word_viewer\\src\\app\\view-elements\\word-viewer\\word-viewer.component.html"],"sourcesContent":["import { Component, Input, ViewEncapsulation, OnInit, Output, EventEmitter } from \"@angular/core\";\r\nimport {\r\n  CrtInterfaceDesignerItem,\r\n  CrtViewElement,\r\n  CrtInput,\r\n  CrtOutput\r\n} from \"@creatio-devkit/common\";\r\nimport * as mammoth from 'mammoth';\r\n\r\n@CrtViewElement({\r\n  selector: \"qnovate-word-viewer\",\r\n  type: \"qnovate.WordViewer\",\r\n})\r\n@CrtInterfaceDesignerItem({\r\n  toolbarConfig: {\r\n    caption: \"Word Viewer\",\r\n    name: \"qnovate-word-viewer\",\r\n    icon: require(\"!!raw-loader?{esModule:false}!./word-viewer-icon.svg\"),\r\n  },\r\n})\r\n@Component({\r\n  selector: \"qnovate-word-viewer\",\r\n  templateUrl: \"./word-viewer.component.html\",\r\n  styleUrls: [\"./word-viewer.component.scss\"],\r\n  encapsulation: ViewEncapsulation.ShadowDom\r\n})\r\nexport class WordViewerComponent implements OnInit {\r\n  @Input()\r\n  @CrtInput()\r\n  set documentUrl(value: string) {\r\n    console.log('Document URL received:', value);\r\n    this._documentUrl = value || '';\r\n    this.loadDocument();\r\n  }\r\n  get documentUrl() {\r\n    return this._documentUrl;\r\n  }\r\n  private _documentUrl: string = '';\r\n\r\n  @Input()\r\n  @CrtInput()\r\n  set documentContent(value: string) {\r\n    console.log('Document content received:', value);\r\n    this._documentContent = value || '';\r\n    this.loadDocument();\r\n  }\r\n  get documentContent() {\r\n    return this._documentContent;\r\n  }\r\n  private _documentContent: string = '';\r\n\r\n  @Input()\r\n  @CrtInput()\r\n  set attachmentId(value: string) {\r\n    console.log('Attachment ID received:', value);\r\n    this._attachmentId = value || '';\r\n    if (this._attachmentId && this._schemaName) {\r\n      this.loadAttachment();\r\n    }\r\n  }\r\n  get attachmentId() {\r\n    return this._attachmentId;\r\n  }\r\n  private _attachmentId: string = '';\r\n\r\n  @Input()\r\n  @CrtInput()\r\n  set schemaName(value: string) {\r\n    console.log('Schema name received:', value);\r\n    this._schemaName = value || '';\r\n    if (this._attachmentId && this._schemaName) {\r\n      this.loadAttachment();\r\n    }\r\n  }\r\n  get schemaName() {\r\n    return this._schemaName;\r\n  }\r\n  private _schemaName: string = '';\r\n\r\n  @Output()\r\n  @CrtOutput()\r\n  loadingStateChange = new EventEmitter<boolean>();\r\n\r\n  @Output()\r\n  @CrtOutput()\r\n  errorChange = new EventEmitter<string>();\r\n  \r\n  isLoading: boolean = false;\r\n  error: string | null = null;\r\n  currentDate: Date = new Date();\r\n\r\n  ngOnInit(): void {\r\n    console.log('Component initialized with:', {\r\n      documentUrl: this.documentUrl,\r\n      documentContent: this.documentContent,\r\n      attachmentId: this.attachmentId,\r\n      schemaName: this.schemaName\r\n    });\r\n  }\r\n\r\n  private setLoading(loading: boolean) {\r\n    this.isLoading = loading;\r\n    this.loadingStateChange.emit(loading);\r\n  }\r\n\r\n  private setError(error: string | null) {\r\n    this.error = error;\r\n    if (error) {\r\n      this.errorChange.emit(error);\r\n    }\r\n  }\r\n\r\n  async loadAttachment() {\r\n    if (!this.attachmentId || !this.schemaName) {\r\n      this.setError(\"Attachment ID or Schema Name not provided\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      this.setLoading(true);\r\n      // Here implement the attachment loading logic using Creatio services\r\n      // This would typically involve querying the attachment and setting documentContent\r\n      this.setLoading(false);\r\n    } catch (err) {\r\n      this.setError(\"Failed to load attachment\");\r\n      this.setLoading(false);\r\n    }\r\n  }\r\n\r\n  convertedHtml: string = '';\r\n\r\n  async loadDocument() {\r\n    if (!this.documentUrl && !this.documentContent) {\r\n      this.setError(\"No document provided\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      this.setLoading(true);\r\n      \r\n      if (this.documentContent) {\r\n        // Convert base64 string to ArrayBuffer\r\n        const binaryString = window.atob(this.documentContent);\r\n        const bytes = new Uint8Array(binaryString.length);\r\n        for (let i = 0; i < binaryString.length; i++) {\r\n          bytes[i] = binaryString.charCodeAt(i);\r\n        }\r\n        \r\n        const result = await mammoth.convertToHtml({arrayBuffer: bytes.buffer});\r\n        this.convertedHtml = result.value;\r\n      } else if (this.documentUrl) {\r\n        const response = await fetch(this.documentUrl);\r\n        const arrayBuffer = await response.arrayBuffer();\r\n        const result = await mammoth.convertToHtml({arrayBuffer});\r\n        this.convertedHtml = result.value;\r\n      }\r\n      \r\n      this.setLoading(false);\r\n    } catch (err) {\r\n      console.error('Document conversion error:', err);\r\n      this.setError(\"Failed to load document\");\r\n      this.setLoading(false);\r\n    }\r\n  }\r\n}","<div class=\"word-viewer-container\">\r\n  <div class=\"toolbar\">\r\n    <button (click)=\"loadDocument()\" [disabled]=\"isLoading\">\r\n      Load Document\r\n    </button>\r\n  </div>\r\n\r\n  <div class=\"content-area\">\r\n    <div *ngIf=\"isLoading\" class=\"loading\">\r\n      Loading document...\r\n    </div>\r\n\r\n    <div *ngIf=\"error\" class=\"error\">\r\n      {{ error }}\r\n    </div>\r\n\r\n    <div class=\"document-content\" *ngIf=\"!isLoading && !error\">\r\n      <div class=\"page\">\r\n        <div [innerHTML]=\"convertedHtml\"></div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}